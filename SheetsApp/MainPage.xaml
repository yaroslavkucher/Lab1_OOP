<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:local="clr-namespace:SheetsApp"
             x:Class="SheetsApp.MainPage"
             BackgroundColor="#1E1E1E">

    <ContentPage.Resources>
        <ResourceDictionary>
            <Style x:Key="PrimaryBtn" TargetType="Button">
                <Setter Property="BackgroundColor" Value="#2E7D32" />
                <Setter Property="TextColor" Value="White" />
                <Setter Property="CornerRadius" Value="8" />
                <Setter Property="FontAttributes" Value="Bold" />
                <Setter Property="HeightRequest" Value="38" />
            </Style>

            <Style x:Key="ActionBtn" TargetType="Button">
                <Setter Property="BackgroundColor" Value="#37474F" />
                <Setter Property="TextColor" Value="White" />
                <Setter Property="CornerRadius" Value="8" />
                <Setter Property="HeightRequest" Value="38" />
            </Style>

            <Style x:Key="DangerBtn" TargetType="Button">
                <Setter Property="BackgroundColor" Value="#C62828" />
                <Setter Property="TextColor" Value="White" />
                <Setter Property="CornerRadius" Value="8" />
                <Setter Property="HeightRequest" Value="38" />
            </Style>

            <Style x:Key="SystemBtn" TargetType="Button">
                <Setter Property="BackgroundColor" Value="Transparent" />
                <Setter Property="TextColor" Value="#B0BEC5" />
                <Setter Property="BorderColor" Value="#546E7A" />
                <Setter Property="BorderWidth" Value="1" />
                <Setter Property="CornerRadius" Value="8" />
                <Setter Property="HeightRequest" Value="38" />
            </Style>
        </ResourceDictionary>
    </ContentPage.Resources>

    <Grid RowDefinitions="Auto, Auto, Auto, *" Padding="10">

        <Grid Grid.Row="0" ColumnDefinitions="Auto, *, Auto" Margin="0,0,0,10">

            <StackLayout Grid.Column="0" Orientation="Horizontal" Spacing="8">
                <Button Text="Save" Clicked="SaveButton_Clicked" Style="{StaticResource PrimaryBtn}" Padding="15,0"/>
                <Button Text="New" Clicked="CreateButton_Clicked" Style="{StaticResource PrimaryBtn}" Padding="15,0"/>
                <Button Text="Open" Clicked="ReadButton_Clicked" Style="{StaticResource ActionBtn}" Padding="15,0"/>
            </StackLayout>

            <StackLayout Grid.Column="2" Orientation="Horizontal" Spacing="8">
                <Button Text="About" Clicked="HelpButton_Clicked" Style="{StaticResource SystemBtn}" Padding="15,0"/>
                <Button Text="Exit" Clicked="ExitButton_Clicked" Style="{StaticResource SystemBtn}" TextColor="#EF9A9A" BorderColor="#EF9A9A" Padding="15,0"/>
            </StackLayout>
        </Grid>

        <StackLayout Grid.Row="1" Orientation="Horizontal" HorizontalOptions="Center" Spacing="20" Margin="0,0,0,15">

            <Frame Padding="0" CornerRadius="8" IsClippedToBounds="True" BorderColor="#C62828" BackgroundColor="#C62828" HasShadow="False" HeightRequest="40">
                <Grid ColumnDefinitions="*, Auto, *" ColumnSpacing="1" WidthRequest="200">
                    <Button Grid.Column="0" Text="Del Row" Clicked="DeleteRowButton_Clicked" BackgroundColor="#C62828" TextColor="White" FontAttributes="Bold" FontSize="13"/>
                    <BoxView Grid.Column="1" WidthRequest="1" Color="#B71C1C" VerticalOptions="FillAndExpand"/>
                    <Button Grid.Column="2" Text="Del Col" Clicked="DeleteColumnButton_Clicked" BackgroundColor="#C62828" TextColor="White" FontAttributes="Bold" FontSize="13"/>
                </Grid>
            </Frame>

            <Frame Padding="0" CornerRadius="8" IsClippedToBounds="True" BorderColor="#37474F" BackgroundColor="#37474F" HasShadow="False" HeightRequest="40">
                <Grid ColumnDefinitions="*, Auto, *" ColumnSpacing="1" WidthRequest="200">
                    <Button Grid.Column="0" Text="Add Row" Clicked="AddRowButton_Clicked" BackgroundColor="#37474F" TextColor="White" FontAttributes="Bold" FontSize="13"/>
                    <BoxView Grid.Column="1" WidthRequest="1" Color="#263238" VerticalOptions="FillAndExpand"/>
                    <Button Grid.Column="2" Text="Add Col" Clicked="AddColumnButton_Clicked" BackgroundColor="#37474F" TextColor="White" FontAttributes="Bold" FontSize="13"/>
                </Grid>
            </Frame>
        </StackLayout>

        <Grid Grid.Row="2" ColumnDefinitions="Auto, *" Margin="0,0,0,10">
            <Label Text="fx" TextColor="#90A4AE" VerticalOptions="Center" FontAttributes="Bold" FontSize="18" Margin="5,0,10,0"/>

            <Frame Grid.Column="1" BackgroundColor="#263238" Padding="10,0" CornerRadius="5" HeightRequest="40" BorderColor="#455A64" HasShadow="False">
                <Entry x:Name="textInput" 
                       TextChanged="OnTextInputTextChanged" 
                       Placeholder="Введіть вираз" 
                       PlaceholderColor="#546E7A" 
                       TextColor="White" 
                       VerticalOptions="Center"/>
            </Frame>
        </Grid>

        <ScrollView Grid.Row="3" Orientation="Both">
            <Grid x:Name="grid">
            </Grid>
        </ScrollView>

    </Grid>
</ContentPage>